FROM python:3.8.13-slim-bullseye

WORKDIR /app

RUN apt-get -y update && apt-get install -y \
  wget \
  wkhtmltopdf

RUN pip install --upgrade setuptools 

COPY requirements.txt .

RUN pip install -r requirements.txt

ADD . . 

ARG POSTGRES
ARG SQLITE
ARG SERVER_MODE
ARG SERIAL
ARG OPENAI_KEY
ARG GOOGLE_OAUTH_CLIENT_ID
ARG GOOGLE_OAUTH_CLIENT_SECRET
ARG OAUTHLIB_RELAX_TOKEN_SCOPE
ARG OAUTHLIB_INSECURE_TRANSPORT
ARG GITHUB_OAUTH_CLIENT_SECRET
ARG GITHUB_OAUTH_CLIENT_ID
ARG ADMIN_USERNAME
ARG ADMIN_PASSWORD
ARG ADMIN_EMAIL
ARG IS_ADMIN
ARG DEV_MAIL_SERVER
ARG DEV_MAIL_PORT
ARG DEV_MAIL_USERNAME
ARG DEV_MAIL_PASSWORD
ARG DEV_SECRET_KEY
ARG DEV_SENDER_EMAIL
ARG PROD_MAIL_SERVER
ARG PROD_MAIL_PORT
ARG PROD_MAIL_USERNAME
ARG PROD_MAIL_PASSWORD
ARG PROD_SECRET_KEY
ARG PROD_SENDER_EMAIL

RUN python init.py

CMD gunicorn app:app 